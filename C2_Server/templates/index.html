{% extends 'base.html' %}
{% block title %}
Super Secret Client Endpoint
{% endblock %}

{% block content %}

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Data Map</title>

    <!-- below are imports for the map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin="" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.2/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.2/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster.js"></script>
</head>

{% if error_message %}
<div class="alert alert-danger" role="alert">
    {{ error_message }} <!-- Corrected here -->
</div>
{% endif %}

<h1 class="pt-5 pb-2">You made it, Welcome to our homebase!</h1>

<div class="container">
    <div class="row">
        <div id="map"></div>
    </div>
</div>

<script src="static/js/script.js"></script>

<!-- Green/black box column -->
<div class="col-md-6">
    <div class="container cursor">
        <form id="myForm" action="{{ url_for('client.index') }}" method="post" class="terminal-form">
            {{ form.csrf_token }}
            <div class="border p-4 rounded">
                <input type="text" name="cmd" class="terminal-input" autofocus placeholder="=> " required>
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            </div>
        </form>
        <div class="row mt-3"> <!-- Add a new row for the "Previous command" section -->
            <div class="col-md-10 col-lg-8 mx-lg-auto mx-md-auto">
                <h3>Previous command:</h3>
                <p class="pt-2"><strong>{{ cmd }}</strong></p>
            </div>
        </div>
    </div>
</div>

<style>
    /* Custom CSS for terminal-like appearance */
    .terminal-form {
        background-color: black;
        color: white;
        border: 2px solid #33cc33; /* Green border */
        border-radius: 5px;
        padding: 10px;
        margin-top: 20px;
        font-family: monospace; /* Use a monospace font for terminal-like appearance */
        height: 300px; /* Adjust the height to your preference */
        overflow-y: auto;
    }
    .terminal-input {
        background-color: transparent; /* Transparent background */
        color: white;
        border: none;
        outline: none;
        font-family: monospace; /* Use a monospace font for terminal-like appearance */
        width: 100%; /* Fill the width of the parent container */
    }
</style>

<script>
    // JavaScript function to handle form submission on Enter key press
    function submitFormOnEnter(event) {
        if (event.keyCode === 13) {  // Check if the pressed key is Enter
            event.preventDefault();  // Prevent the default form submission
            document.getElementById('myForm').submit();  // Submit the form
        }
    }

    // Attach keydown event listener to the form input field(s)
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelector('.terminal-input').addEventListener('keydown', submitFormOnEnter);
    });
</script>

{% endblock %}
